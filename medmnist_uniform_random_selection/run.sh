if [ $1 = "bloodmnist" ]; then if [ -d "logs/bloodmnist" ]; then echo "exists"; else `mkdir -p logs/bloodmnist`; fi; MNIST_NAME=( bloodmnist ); PARTIAL_LIST=( $(seq 1.00000 0.00100 1.00000) $(seq 0.00100 0.00100 0.00900) $(seq 0.01000 0.01000 0.09000) $(seq 0.10000 0.10000 0.90000) ); fi
if [ $1 = "breastmnist" ]; then if [ -d "logs/breastmnist" ]; then echo "exists"; else `mkdir -p logs/breastmnist`; fi; MNIST_NAME=( breastmnist ); PARTIAL_LIST=( $(seq 1.00000 0.00005 1.00000) $(seq 0.00500 0.00500 0.09500) $(seq 0.10000 0.05000 0.95000) ); fi
if [ $1 = "dermamnist" ]; then if [ -d "logs/dermamnist" ]; then echo "exists"; else `mkdir -p logs/dermamnist`; fi; MNIST_NAME=( dermamnist ); PARTIAL_LIST=( $(seq 1.00000 0.00005 1.00000) $(seq 0.00100 0.00100 0.00900) $(seq 0.01000 0.01000 0.09000) $(seq 0.10000 0.10000 0.90000) ); fi
if [ $1 = "octmnist" ]; then if [ -d "logs/octmnist" ]; then echo "exists"; else `mkdir -p logs/octmnist`; fi; MNIST_NAME=( octmnist ); PARTIAL_LIST=( $(seq 1.00000 0.00005 1.00000) $(seq 0.00010 0.00005 0.00095) $(seq 0.00100 0.00050 0.00950) $(seq 0.01000 0.00500 0.09500) $(seq 0.10000 0.05000 0.95000) ); fi
if [ $1 = "organamnist" ]; then if [ -d "logs/organamnist" ]; then echo "exists"; else `mkdir -p logs/organamnist`; fi; MNIST_NAME=( organamnist ); PARTIAL_LIST=( $(seq 1.00000 0.00005 1.00000) $(seq 0.00050 0.00010 0.00090) $(seq 0.00100 0.00100 0.00900) $(seq 0.01000 0.01000 0.09000) $(seq 0.10000 0.10000 0.90000) ); fi
if [ $1 = "organcmnist" ]; then if [ -d "logs/organcmnist" ]; then echo "exists"; else `mkdir -p logs/organcmnist`; fi; MNIST_NAME=( organcmnist ); PARTIAL_LIST=( $(seq 1.00000 0.00005 1.00000) $(seq 0.00100 0.00100 0.00900) $(seq 0.01000 0.01000 0.09000) $(seq 0.10000 0.10000 0.90000) ); fi
if [ $1 = "organsmnist" ]; then if [ -d "logs/organsmnist" ]; then echo "exists"; else `mkdir -p logs/organsmnist`; fi; MNIST_NAME=( organsmnist ); PARTIAL_LIST=( $(seq 1.00000 0.00005 1.00000) $(seq 0.00100 0.00100 0.00900) $(seq 0.01000 0.01000 0.09000) $(seq 0.10000 0.10000 0.90000) ); fi
if [ $1 = "pathmnist" ]; then if [ -d "logs/pathmnist" ]; then echo "exists"; else `mkdir -p logs/pathmnist`; fi; MNIST_NAME=( pathmnist ); PARTIAL_LIST=( $(seq 1.00000 0.00005 1.00000) $(seq 0.00015 0.00005 0.00095) $(seq 0.00100 0.00050 0.00950) $(seq 0.01000 0.00500 0.09500) $(seq 0.10000 0.05000 0.95000) ); fi
if [ $1 = "pneumoniamnist" ]; then if [ -d "logs/pneumoniamnist" ]; then echo "exists"; else `mkdir -p logs/pneumoniamnist`; fi; MNIST_NAME=( pneumoniamnist ); PARTIAL_LIST=( $(seq 1.00000 0.00005 1.00000) $(seq 0.00100 0.00100 0.00900) $(seq 0.01000 0.01000 0.09000) $(seq 0.10000 0.10000 0.90000) ); fi
if [ $1 = "tissuemnist" ]; then if [ -d "logs/tissuemnist" ]; then echo "exists"; else `mkdir -p logs/tissuemnist`; fi; MNIST_NAME=( tissuemnist ); PARTIAL_LIST=( $(seq 1.00000 0.00005 1.00000) $(seq 0.00010 0.00005 0.00095) $(seq 0.00100 0.00050 0.00950) $(seq 0.01000 0.00500 0.09500) $(seq 0.10000 0.05000 0.95000) ); fi
if [ $1 = "retinamnist" ]; then if [ -d "logs/retinamnist" ]; then echo "exists"; else `mkdir -p logs/retinamnist`; fi; MNIST_NAME=( retinamnist ); PARTIAL_LIST=( $(seq 1.00000 0.00005 1.00000) $(seq 0.01000 0.00500 0.09500) $(seq 0.10000 0.05000 0.95000) ); fi

for init in imagenet; do for run in {1..1}; do for task in "${MNIST_NAME[@]}"; do for partial in "${PARTIAL_LIST[@]}"; do while true; do if [ $(myjobs | wc -l) -lt 999 ]; then if [ ! -f logs/$task/$task-$run-p$partial.out ]; then sbatch --error=logs/$task/$task-$run-p$partial.out --output=logs/$task/$task-$run-p$partial.out hg.sh $run $task $partial $init; echo "logs/$task/$task-$run-p$partial.out"; break; else line="$(tail -n 1 logs/$task/$task-$run-p$partial.out)"; if [[ "$line" != *"AVERAGE"* ]] && [[ "$line" != *"reraise"* ]]; then sbatch --error=logs/$task/$task-$run-p$partial.out --output=logs/$task/$task-$run-p$partial.out hg.sh $run $task $partial $init; echo "logs/$task/$task-$run-p$partial.out"; break; else break; fi; fi; fi; sleep 10s; done; done; done; done; done
